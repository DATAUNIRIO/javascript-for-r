<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Image Classifier | JavaScript for R</title>
  <meta name="description" content="Invite JavaScript into your Data Science workflow." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Image Classifier | JavaScript for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Invite JavaScript into your Data Science workflow." />
  <meta name="github-repo" content="JohnCoene/javascript-for-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Image Classifier | JavaScript for R" />
  
  <meta name="twitter:description" content="Invite JavaScript into your Data Science workflow." />
  

<meta name="author" content="John Coene" />


<meta name="date" content="2020-08-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="node.html"/>
<link rel="next" href="progress-bar.html"/>
<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block/empty-anchor.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/plotly-binding/plotly.js"></script>
<script src="libs/typedarray/typedarray.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main/plotly-latest.min.js"></script>
<script src="libs/core-js/shim.min.js"></script>
<script src="libs/react/react.min.js"></script>
<script src="libs/react/react-dom.min.js"></script>
<script src="libs/reactwidget/react-tools.js"></script>
<script src="libs/reactable-binding/reactable.js"></script>
<script src="libs/r2d3-render/r2d3-render.js"></script>
<script src="libs/webcomponents/webcomponents.js"></script>
<script src="libs/r2d3-binding/r2d3.js"></script>
<script src="libs/d3v5/d3.min.js"></script>
<script src="libs/viz/viz.js"></script>
<link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">JavaScript for R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#premise"><i class="fa fa-check"></i>Premise</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#book-structure"><i class="fa fa-check"></i>Book Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgement"><i class="fa fa-check"></i>Acknowledgement</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i>Disclaimer</a></li>
</ul></li>
<li class="part"><span><b>I Basics &amp; Roadmap</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#rationale"><i class="fa fa-check"></i><b>1.1</b> Rationale</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#methods"><i class="fa fa-check"></i><b>1.2</b> Methods</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#v8"><i class="fa fa-check"></i><b>1.2.1</b> V8</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#htmlwidgets"><i class="fa fa-check"></i><b>1.2.2</b> htmlwidgets</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#shiny"><i class="fa fa-check"></i><b>1.2.3</b> Shiny</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#bubble"><i class="fa fa-check"></i><b>1.2.4</b> bubble</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#methods-amiss"><i class="fa fa-check"></i><b>1.3</b> Methods Amiss</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#reactr"><i class="fa fa-check"></i><b>1.3.1</b> reactR</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#r2d3"><i class="fa fa-check"></i><b>1.3.2</b> r2d3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prerequisites.html"><a href="prerequisites.html#r-package-development"><i class="fa fa-check"></i><b>2.1</b> R Package Development</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="prerequisites.html"><a href="prerequisites.html#creating-a-package"><i class="fa fa-check"></i><b>2.1.1</b> Creating a Package</a></li>
<li class="chapter" data-level="2.1.2" data-path="prerequisites.html"><a href="prerequisites.html#metadata"><i class="fa fa-check"></i><b>2.1.2</b> Metadata</a></li>
<li class="chapter" data-level="2.1.3" data-path="prerequisites.html"><a href="prerequisites.html#r-code"><i class="fa fa-check"></i><b>2.1.3</b> R code</a></li>
<li class="chapter" data-level="2.1.4" data-path="prerequisites.html"><a href="prerequisites.html#documentation"><i class="fa fa-check"></i><b>2.1.4</b> Documentation</a></li>
<li class="chapter" data-level="2.1.5" data-path="prerequisites.html"><a href="prerequisites.html#installed-files"><i class="fa fa-check"></i><b>2.1.5</b> Installed files</a></li>
<li class="chapter" data-level="2.1.6" data-path="prerequisites.html"><a href="prerequisites.html#build-load-and-install"><i class="fa fa-check"></i><b>2.1.6</b> Build, load, and install</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="prerequisites.html"><a href="prerequisites.html#json"><i class="fa fa-check"></i><b>2.2</b> JSON</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="prerequisites.html"><a href="prerequisites.html#serialising"><i class="fa fa-check"></i><b>2.2.1</b> Serialising</a></li>
<li class="chapter" data-level="2.2.2" data-path="prerequisites.html"><a href="prerequisites.html#tabular-data"><i class="fa fa-check"></i><b>2.2.2</b> Tabular data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="prerequisites.html"><a href="prerequisites.html#javascript"><i class="fa fa-check"></i><b>2.3</b> JavaScript</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prerequisites.html"><a href="prerequisites.html#developer-tools"><i class="fa fa-check"></i><b>2.3.1</b> Developer tools</a></li>
<li class="chapter" data-level="2.3.2" data-path="prerequisites.html"><a href="prerequisites.html#variable-declaration-and-scope"><i class="fa fa-check"></i><b>2.3.2</b> Variable declaration and scope</a></li>
<li class="chapter" data-level="2.3.3" data-path="prerequisites.html"><a href="prerequisites.html#document-object-model"><i class="fa fa-check"></i><b>2.3.3</b> Document object model</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Data Visualisation</b></span></li>
<li class="chapter" data-level="3" data-path="introduction-to-widgets.html"><a href="introduction-to-widgets.html"><i class="fa fa-check"></i><b>3</b> Introduction to widgets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-widgets.html"><a href="introduction-to-widgets.html#plotly-package"><i class="fa fa-check"></i><b>3.1</b> Plotly package</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-widgets.html"><a href="introduction-to-widgets.html#dt-package"><i class="fa fa-check"></i><b>3.2</b> DT package</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html"><i class="fa fa-check"></i><b>4</b> Basics of building widgets</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html#candidate-libraries"><i class="fa fa-check"></i><b>4.1</b> Candidate Libraries</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html#plotly"><i class="fa fa-check"></i><b>4.1.1</b> Plotly</a></li>
<li class="chapter" data-level="4.1.2" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html#highchart.js"><i class="fa fa-check"></i><b>4.1.2</b> Highchart.js</a></li>
<li class="chapter" data-level="4.1.3" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html#chart.js"><i class="fa fa-check"></i><b>4.1.3</b> Chart.js</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html#how-it-works"><i class="fa fa-check"></i><b>4.2</b> How it works</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="your-first-widget.html"><a href="your-first-widget.html"><i class="fa fa-check"></i><b>5</b> Your First Widget</a>
<ul>
<li class="chapter" data-level="5.1" data-path="your-first-widget.html"><a href="your-first-widget.html#the-scaffold"><i class="fa fa-check"></i><b>5.1</b> The Scaffold</a></li>
<li class="chapter" data-level="5.2" data-path="your-first-widget.html"><a href="your-first-widget.html#the-output"><i class="fa fa-check"></i><b>5.2</b> The Output</a></li>
<li class="chapter" data-level="5.3" data-path="your-first-widget.html"><a href="your-first-widget.html#javascript-side"><i class="fa fa-check"></i><b>5.3</b> JavaScript-side</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-realistic-widget.html"><a href="a-realistic-widget.html"><i class="fa fa-check"></i><b>6</b> A Realistic Widget</a>
<ul>
<li class="chapter" data-level="6.1" data-path="a-realistic-widget.html"><a href="a-realistic-widget.html#dependency"><i class="fa fa-check"></i><b>6.1</b> Dependency</a></li>
<li class="chapter" data-level="6.2" data-path="prerequisites.html"><a href="prerequisites.html#javascript"><i class="fa fa-check"></i><b>6.2</b> JavaScript</a></li>
<li class="chapter" data-level="6.3" data-path="a-realistic-widget.html"><a href="a-realistic-widget.html#html-element"><i class="fa fa-check"></i><b>6.3</b> HTML Element</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="the-full-monty.html"><a href="the-full-monty.html"><i class="fa fa-check"></i><b>7</b> The Full Monty</a>
<ul>
<li class="chapter" data-level="7.1" data-path="the-full-monty.html"><a href="the-full-monty.html#dependencies"><i class="fa fa-check"></i><b>7.1</b> Dependencies</a></li>
<li class="chapter" data-level="7.2" data-path="prerequisites.html"><a href="prerequisites.html#javascript"><i class="fa fa-check"></i><b>7.2</b> JavaScript</a></li>
<li class="chapter" data-level="7.3" data-path="the-full-monty.html"><a href="the-full-monty.html#working-with-data"><i class="fa fa-check"></i><b>7.3</b> Working with Data</a></li>
<li class="chapter" data-level="7.4" data-path="the-full-monty.html"><a href="the-full-monty.html#transforming-data"><i class="fa fa-check"></i><b>7.4</b> Transforming Data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="the-full-monty.html"><a href="the-full-monty.html#in-javascript"><i class="fa fa-check"></i><b>7.4.1</b> In JavaScript</a></li>
<li class="chapter" data-level="7.4.2" data-path="the-full-monty.html"><a href="the-full-monty.html#in-r"><i class="fa fa-check"></i><b>7.4.2</b> In R</a></li>
<li class="chapter" data-level="7.4.3" data-path="the-full-monty.html"><a href="the-full-monty.html#pros-cons"><i class="fa fa-check"></i><b>7.4.3</b> Pros &amp; Cons</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="the-full-monty.html"><a href="the-full-monty.html#on-print"><i class="fa fa-check"></i><b>7.5</b> On Print</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="advanced-topics.html"><a href="advanced-topics.html"><i class="fa fa-check"></i><b>8</b> Advanced Topics</a>
<ul>
<li class="chapter" data-level="8.1" data-path="advanced-topics.html"><a href="advanced-topics.html#shared-variables"><i class="fa fa-check"></i><b>8.1</b> Shared Variables</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="advanced-topics.html"><a href="advanced-topics.html#sizing"><i class="fa fa-check"></i><b>8.1.1</b> Sizing</a></li>
<li class="chapter" data-level="8.1.2" data-path="advanced-topics.html"><a href="advanced-topics.html#sizing-policy"><i class="fa fa-check"></i><b>8.1.2</b> Sizing Policy</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="advanced-topics.html"><a href="advanced-topics.html#resizing"><i class="fa fa-check"></i><b>8.2</b> Resizing</a></li>
<li class="chapter" data-level="8.3" data-path="advanced-topics.html"><a href="advanced-topics.html#pre-render-hooks-security"><i class="fa fa-check"></i><b>8.3</b> Pre Render Hooks &amp; Security</a></li>
<li class="chapter" data-level="8.4" data-path="advanced-topics.html"><a href="advanced-topics.html#javascript-code"><i class="fa fa-check"></i><b>8.4</b> JavaScript Code</a></li>
<li class="chapter" data-level="8.5" data-path="advanced-topics.html"><a href="advanced-topics.html#prepend-append-content"><i class="fa fa-check"></i><b>8.5</b> Prepend &amp; Append Content</a></li>
<li class="chapter" data-level="8.6" data-path="the-full-monty.html"><a href="the-full-monty.html#dependencies"><i class="fa fa-check"></i><b>8.6</b> Dependencies</a></li>
<li class="chapter" data-level="8.7" data-path="advanced-topics.html"><a href="advanced-topics.html#compatibility"><i class="fa fa-check"></i><b>8.7</b> Compatibility</a></li>
<li class="chapter" data-level="8.8" data-path="advanced-topics.html"><a href="advanced-topics.html#unit-tests"><i class="fa fa-check"></i><b>8.8</b> Unit Tests</a></li>
<li class="chapter" data-level="8.9" data-path="advanced-topics.html"><a href="advanced-topics.html#performances"><i class="fa fa-check"></i><b>8.9</b> Performances</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="crosstalk.html"><a href="crosstalk.html"><i class="fa fa-check"></i><b>9</b> Crosstalk</a>
<ul>
<li class="chapter" data-level="9.1" data-path="crosstalk.html"><a href="crosstalk.html#crosstalk-example"><i class="fa fa-check"></i><b>9.1</b> Crosstalk example</a></li>
<li class="chapter" data-level="9.2" data-path="crosstalk.html"><a href="crosstalk.html#crosstalk-requirements"><i class="fa fa-check"></i><b>9.2</b> Crosstalk requirements</a></li>
<li class="chapter" data-level="9.3" data-path="basics-of-building-widgets.html"><a href="basics-of-building-widgets.html#how-it-works"><i class="fa fa-check"></i><b>9.3</b> How it works</a></li>
<li class="chapter" data-level="9.4" data-path="crosstalk.html"><a href="crosstalk.html#crosstalk-with-gio"><i class="fa fa-check"></i><b>9.4</b> Crosstalk with gio</a></li>
<li class="chapter" data-level="9.5" data-path="crosstalk.html"><a href="crosstalk.html#adapt-the-r-code"><i class="fa fa-check"></i><b>9.5</b> Adapt the R code</a></li>
<li class="chapter" data-level="9.6" data-path="crosstalk.html"><a href="crosstalk.html#change-the-javascript-code"><i class="fa fa-check"></i><b>9.6</b> Change the JavaScript code</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="crosstalk.html"><a href="crosstalk.html#send-selected-keys"><i class="fa fa-check"></i><b>9.6.1</b> Send selected keys</a></li>
<li class="chapter" data-level="9.6.2" data-path="crosstalk.html"><a href="crosstalk.html#set-selected-keys"><i class="fa fa-check"></i><b>9.6.2</b> Set selected keys</a></li>
<li class="chapter" data-level="9.6.3" data-path="crosstalk.html"><a href="crosstalk.html#using-crosstalk-with-gio"><i class="fa fa-check"></i><b>9.6.3</b> Using crosstalk with gio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="final-revisions.html"><a href="final-revisions.html"><i class="fa fa-check"></i><b>10</b> Final Revisions</a>
<ul>
<li class="chapter" data-level="10.1" data-path="the-full-monty.html"><a href="the-full-monty.html#working-with-data"><i class="fa fa-check"></i><b>10.1</b> Working with data</a></li>
<li class="chapter" data-level="10.2" data-path="final-revisions.html"><a href="final-revisions.html#plethora-of-options"><i class="fa fa-check"></i><b>10.2</b> Plethora of options</a></li>
<li class="chapter" data-level="10.3" data-path="final-revisions.html"><a href="final-revisions.html#interface-design"><i class="fa fa-check"></i><b>10.3</b> Interface design</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="excercise-ploty.html"><a href="excercise-ploty.html"><i class="fa fa-check"></i><b>11</b> Excercise - Ploty</a>
<ul>
<li class="chapter" data-level="11.1" data-path="excercise-ploty.html"><a href="excercise-ploty.html#discover"><i class="fa fa-check"></i><b>11.1</b> Discover</a></li>
<li class="chapter" data-level="11.2" data-path="excercise-ploty.html"><a href="excercise-ploty.html#basics"><i class="fa fa-check"></i><b>11.2</b> Basics</a></li>
<li class="chapter" data-level="11.3" data-path="excercise-ploty.html"><a href="excercise-ploty.html#javascript-to-r"><i class="fa fa-check"></i><b>11.3</b> JavaScript to R</a></li>
<li class="chapter" data-level="11.4" data-path="excercise-ploty.html"><a href="excercise-ploty.html#r-to-javascript"><i class="fa fa-check"></i><b>11.4</b> R to JavaScript</a></li>
<li class="chapter" data-level="11.5" data-path="excercise-ploty.html"><a href="excercise-ploty.html#size-resize"><i class="fa fa-check"></i><b>11.5</b> Size &amp; Resize</a></li>
<li class="chapter" data-level="11.6" data-path="excercise-ploty.html"><a href="excercise-ploty.html#performance-security"><i class="fa fa-check"></i><b>11.6</b> Performance &amp; Security</a></li>
</ul></li>
<li class="part"><span><b>III Web Development with Shiny</b></span></li>
<li class="chapter" data-level="12" data-path="excercise-ploty.html"><a href="excercise-ploty.html#discover"><i class="fa fa-check"></i><b>12</b> Discover</a>
<ul>
<li class="chapter" data-level="12.1" data-path="discover.html"><a href="discover.html"><i class="fa fa-check"></i><b>12.1</b> Static Files</a></li>
<li class="chapter" data-level="12.2" data-path="discover.html"><a href="discover.html#example---alerts"><i class="fa fa-check"></i><b>12.2</b> Example - Alerts</a></li>
<li class="chapter" data-level="12.3" data-path="discover.html"><a href="discover.html#from-r-to-javascript"><i class="fa fa-check"></i><b>12.3</b> From R to JavaScript</a></li>
<li class="chapter" data-level="12.4" data-path="discover.html"><a href="discover.html#from-javascript-to-r"><i class="fa fa-check"></i><b>12.4</b> From JavaScript to R</a></li>
<li class="chapter" data-level="12.5" data-path="discover.html"><a href="discover.html#deserialise"><i class="fa fa-check"></i><b>12.5</b> Deserialise</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="a-complete-integration.html"><a href="a-complete-integration.html"><i class="fa fa-check"></i><b>13</b> A Complete Integration</a>
<ul>
<li class="chapter" data-level="13.1" data-path="a-complete-integration.html"><a href="a-complete-integration.html#serialisation"><i class="fa fa-check"></i><b>13.1</b> Serialisation</a></li>
<li class="chapter" data-level="13.2" data-path="a-complete-integration.html"><a href="a-complete-integration.html#events-callbacks"><i class="fa fa-check"></i><b>13.2</b> Events &amp; Callbacks</a></li>
<li class="chapter" data-level="13.3" data-path="a-complete-integration.html"><a href="a-complete-integration.html#as-a-package"><i class="fa fa-check"></i><b>13.3</b> As a Package</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="the-full-monty.html"><a href="the-full-monty.html#dependencies"><i class="fa fa-check"></i><b>13.3.1</b> Dependencies</a></li>
<li class="chapter" data-level="13.3.2" data-path="prerequisites.html"><a href="prerequisites.html#r-code"><i class="fa fa-check"></i><b>13.3.2</b> R Code</a></li>
<li class="chapter" data-level="13.3.3" data-path="advanced-topics.html"><a href="advanced-topics.html#javascript-code"><i class="fa fa-check"></i><b>13.3.3</b> JavaScript Code</a></li>
<li class="chapter" data-level="13.3.4" data-path="a-complete-integration.html"><a href="a-complete-integration.html#input-handler"><i class="fa fa-check"></i><b>13.3.4</b> Input Handler</a></li>
<li class="chapter" data-level="13.3.5" data-path="a-complete-integration.html"><a href="a-complete-integration.html#wrapping-up"><i class="fa fa-check"></i><b>13.3.5</b> Wrapping up</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="tips-tricks.html"><a href="tips-tricks.html"><i class="fa fa-check"></i><b>14</b> Tips &amp; Tricks</a>
<ul>
<li class="chapter" data-level="14.1" data-path="tips-tricks.html"><a href="tips-tricks.html#shiny-events"><i class="fa fa-check"></i><b>14.1</b> Shiny Events</a></li>
<li class="chapter" data-level="14.2" data-path="tips-tricks.html"><a href="tips-tricks.html#table-buttons"><i class="fa fa-check"></i><b>14.2</b> Table Buttons</a></li>
<li class="chapter" data-level="14.3" data-path="tips-tricks.html"><a href="tips-tricks.html#jquery---toggle"><i class="fa fa-check"></i><b>14.3</b> jQuery - Toggle</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="custom-outputs.html"><a href="custom-outputs.html"><i class="fa fa-check"></i><b>15</b> Custom Outputs</a>
<ul>
<li class="chapter" data-level="15.1" data-path="custom-outputs.html"><a href="custom-outputs.html#inner-workings"><i class="fa fa-check"></i><b>15.1</b> Inner-workings</a></li>
<li class="chapter" data-level="15.2" data-path="custom-outputs.html"><a href="custom-outputs.html#discover-lena.js"><i class="fa fa-check"></i><b>15.2</b> Discover Lena.js</a></li>
<li class="chapter" data-level="15.3" data-path="custom-outputs.html"><a href="custom-outputs.html#setup"><i class="fa fa-check"></i><b>15.3</b> Setup</a></li>
<li class="chapter" data-level="15.4" data-path="custom-outputs.html"><a href="custom-outputs.html#output"><i class="fa fa-check"></i><b>15.4</b> Output</a></li>
<li class="chapter" data-level="15.5" data-path="custom-outputs.html"><a href="custom-outputs.html#render"><i class="fa fa-check"></i><b>15.5</b> Render</a></li>
<li class="chapter" data-level="15.6" data-path="custom-outputs.html"><a href="custom-outputs.html#javascript-binding"><i class="fa fa-check"></i><b>15.6</b> JavaScript Binding</a></li>
<li class="chapter" data-level="15.7" data-path="custom-outputs.html"><a href="custom-outputs.html#test"><i class="fa fa-check"></i><b>15.7</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="cookies.html"><a href="cookies.html"><i class="fa fa-check"></i><b>16</b> Cookies</a>
<ul>
<li class="chapter" data-level="16.1" data-path="cookies.html"><a href="cookies.html#discover-js-cookie"><i class="fa fa-check"></i><b>16.1</b> Discover js-cookie</a></li>
<li class="chapter" data-level="16.2" data-path="custom-outputs.html"><a href="custom-outputs.html#setup"><i class="fa fa-check"></i><b>16.2</b> Setup</a></li>
<li class="chapter" data-level="16.3" data-path="prerequisites.html"><a href="prerequisites.html#javascript"><i class="fa fa-check"></i><b>16.3</b> JavaScript</a></li>
<li class="chapter" data-level="16.4" data-path="prerequisites.html"><a href="prerequisites.html#r-code"><i class="fa fa-check"></i><b>16.4</b> R Code</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html"><i class="fa fa-check"></i><b>17</b> Widgets with Shiny</a>
<ul>
<li class="chapter" data-level="17.1" data-path="excercise-ploty.html"><a href="excercise-ploty.html#javascript-to-r"><i class="fa fa-check"></i><b>17.1</b> JavaScript to R</a></li>
<li class="chapter" data-level="17.2" data-path="a-complete-integration.html"><a href="a-complete-integration.html#input-handler"><i class="fa fa-check"></i><b>17.2</b> Input Handler</a></li>
<li class="chapter" data-level="17.3" data-path="excercise-ploty.html"><a href="excercise-ploty.html#r-to-javascript"><i class="fa fa-check"></i><b>17.3</b> R to JavaScript</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html#send-data"><i class="fa fa-check"></i><b>17.3.1</b> Send Data</a></li>
<li class="chapter" data-level="17.3.2" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html#retrieve-widget-instance"><i class="fa fa-check"></i><b>17.3.2</b> Retrieve Widget Instance</a></li>
<li class="chapter" data-level="17.3.3" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html#handle-data"><i class="fa fa-check"></i><b>17.3.3</b> Handle Data</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html#proxy-function"><i class="fa fa-check"></i><b>17.4</b> Proxy Function</a></li>
<li class="chapter" data-level="17.5" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html#clear-data"><i class="fa fa-check"></i><b>17.5</b> Clear Data</a></li>
<li class="chapter" data-level="17.6" data-path="widgets-with-shiny.html"><a href="widgets-with-shiny.html#update"><i class="fa fa-check"></i><b>17.6</b> Update</a></li>
</ul></li>
<li class="part"><span><b>IV JavaScript for Computations</b></span></li>
<li class="chapter" data-level="18" data-path="the-v8-engine.html"><a href="the-v8-engine.html"><i class="fa fa-check"></i><b>18</b> The V8 Engine</a>
<ul>
<li class="chapter" data-level="18.1" data-path="the-v8-engine.html"><a href="the-v8-engine.html#installation"><i class="fa fa-check"></i><b>18.1</b> Installation</a></li>
<li class="chapter" data-level="18.2" data-path="excercise-ploty.html"><a href="excercise-ploty.html#basics"><i class="fa fa-check"></i><b>18.2</b> Basics</a></li>
<li class="chapter" data-level="18.3" data-path="the-v8-engine.html"><a href="the-v8-engine.html#external-libraries"><i class="fa fa-check"></i><b>18.3</b> External Libraries</a></li>
<li class="chapter" data-level="18.4" data-path="the-v8-engine.html"><a href="the-v8-engine.html#with-npm"><i class="fa fa-check"></i><b>18.4</b> With Npm</a></li>
<li class="chapter" data-level="18.5" data-path="the-v8-engine.html"><a href="the-v8-engine.html#use-in-packages"><i class="fa fa-check"></i><b>18.5</b> Use in Packages</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="node.html"><a href="node.html"><i class="fa fa-check"></i><b>19</b> Node.js with Bubble</a>
<ul>
<li class="chapter" data-level="19.1" data-path="excercise-ploty.html"><a href="excercise-ploty.html#basics"><i class="fa fa-check"></i><b>19.1</b> Basics</a></li>
<li class="chapter" data-level="19.2" data-path="node.html"><a href="node.html#r-markdown-engine"><i class="fa fa-check"></i><b>19.2</b> R Markdown Engine</a></li>
<li class="chapter" data-level="19.3" data-path="node.html"><a href="node.html#npm"><i class="fa fa-check"></i><b>19.3</b> Npm</a></li>
</ul></li>
<li class="part"><span><b>V Examples</b></span></li>
<li class="chapter" data-level="20" data-path="image-classifier.html"><a href="image-classifier.html"><i class="fa fa-check"></i><b>20</b> Image Classifier</a>
<ul>
<li class="chapter" data-level="20.1" data-path="excercise-ploty.html"><a href="excercise-ploty.html#discover"><i class="fa fa-check"></i><b>20.1</b> Discover</a></li>
<li class="chapter" data-level="20.2" data-path="custom-outputs.html"><a href="custom-outputs.html#setup"><i class="fa fa-check"></i><b>20.2</b> Setup</a></li>
<li class="chapter" data-level="20.3" data-path="prerequisites.html"><a href="prerequisites.html#javascript"><i class="fa fa-check"></i><b>20.3</b> JavaScript</a></li>
<li class="chapter" data-level="20.4" data-path="a-complete-integration.html"><a href="a-complete-integration.html#input-handler"><i class="fa fa-check"></i><b>20.4</b> Input Handler</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="progress-bar.html"><a href="progress-bar.html"><i class="fa fa-check"></i><b>21</b> Progress Bar</a>
<ul>
<li class="chapter" data-level="21.1" data-path="prerequisites.html"><a href="prerequisites.html#r-code"><i class="fa fa-check"></i><b>21.1</b> R code</a></li>
<li class="chapter" data-level="21.2" data-path="advanced-topics.html"><a href="advanced-topics.html#javascript-code"><i class="fa fa-check"></i><b>21.2</b> JavaScript code</a></li>
<li class="chapter" data-level="21.3" data-path="progress-bar.html"><a href="progress-bar.html#events"><i class="fa fa-check"></i><b>21.3</b> Events</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>22</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="22.1" data-path="a-realistic-widget.html"><a href="a-realistic-widget.html#dependency"><i class="fa fa-check"></i><b>22.1</b> Dependency</a></li>
<li class="chapter" data-level="22.2" data-path="machine-learning.html"><a href="machine-learning.html#simple-regression"><i class="fa fa-check"></i><b>22.2</b> Simple Regression</a></li>
</ul></li>
<li class="part"><span><b>VI Closing Remarks</b></span></li>
<li class="chapter" data-level="23" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>23</b> Conclusion</a>
<ul>
<li class="chapter" data-level="23.1" data-path="advanced-topics.html"><a href="advanced-topics.html#performances"><i class="fa fa-check"></i><b>23.1</b> Performances</a></li>
<li class="chapter" data-level="23.2" data-path="conclusion.html"><a href="conclusion.html#road-ahead"><i class="fa fa-check"></i><b>23.2</b> Road ahead</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="conclusion.html"><a href="conclusion.html#computation"><i class="fa fa-check"></i><b>23.2.1</b> Computation</a></li>
<li class="chapter" data-level="23.2.2" data-path="introduction.html"><a href="introduction.html#shiny"><i class="fa fa-check"></i><b>23.2.2</b> Shiny</a></li>
<li class="chapter" data-level="23.2.3" data-path="introduction.html"><a href="introduction.html#htmlwidgets"><i class="fa fa-check"></i><b>23.2.3</b> htmlwidgets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">JavaScript for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="image-classifier" class="section level1" number="20">
<h1><span class="header-section-number">Chapter 20</span> Image Classifier</h1>
<p>In this example we bring <a href="https://learn.ml5js.org/">ml5.js</a> to R using Shiny, more specifically its image classifier using <a href="https://arxiv.org/abs/1704.04861">mobileNet</a>. Using shiny and JavaScript the model can run in the client’s browser and the predictions can be sent back to the server. This means the model uses the client’s computing power to run the prediction rather than the server, thereby alleviating computation on the server and bypassing shiny’s limitations with regard to concurrent users.</p>
<div id="discover" class="section level2" number="20.1">
<h2><span class="header-section-number">20.1</span> Discover</h2>
<p>Then again the journey starts by exploring ml5.js and the classifier we are going to use. One starts by instantiating an image classifier, specifying the model to use (ml5.js comes with a few out of the box but also allows using custom models), then the classifier is used on an image present in the DOM.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb424-1"><a href="image-classifier.html#cb424-1"></a><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></span>
<span id="cb424-2"><a href="image-classifier.html#cb424-2"></a><span class="kw">&lt;html</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.w3.org/1999/xhtml&quot;</span><span class="ot"> lang=</span><span class="st">&quot;&quot;</span><span class="ot"> xml:lang=</span><span class="st">&quot;&quot;</span><span class="kw">&gt;</span></span>
<span id="cb424-3"><a href="image-classifier.html#cb424-3"></a></span>
<span id="cb424-4"><a href="image-classifier.html#cb424-4"></a><span class="kw">&lt;head&gt;</span></span>
<span id="cb424-5"><a href="image-classifier.html#cb424-5"></a>  <span class="co">&lt;!-- Import library --&gt;</span></span>
<span id="cb424-6"><a href="image-classifier.html#cb424-6"></a>  <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;https://unpkg.com/ml5@0.4.3/dist/ml5.min.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb424-7"><a href="image-classifier.html#cb424-7"></a><span class="kw">&lt;/head&gt;</span></span>
<span id="cb424-8"><a href="image-classifier.html#cb424-8"></a></span>
<span id="cb424-9"><a href="image-classifier.html#cb424-9"></a><span class="kw">&lt;body&gt;</span></span>
<span id="cb424-10"><a href="image-classifier.html#cb424-10"></a>  <span class="co">&lt;!-- image to classify --&gt;</span></span>
<span id="cb424-11"><a href="image-classifier.html#cb424-11"></a>  <span class="kw">&lt;img</span><span class="ot"> id=</span><span class="st">&quot;dog&quot;</span><span class="ot"> src=</span><span class="st">&quot;www/doge.jpg&quot;</span><span class="kw">/&gt;</span></span>
<span id="cb424-12"><a href="image-classifier.html#cb424-12"></a></span>
<span id="cb424-13"><a href="image-classifier.html#cb424-13"></a>  <span class="co">&lt;!-- Script to run classifier --&gt;</span></span>
<span id="cb424-14"><a href="image-classifier.html#cb424-14"></a>  <span class="kw">&lt;script&gt;</span></span>
<span id="cb424-15"><a href="image-classifier.html#cb424-15"></a>    <span class="co">// Initialize the Image Classifier method with MobileNet</span></span>
<span id="cb424-16"><a href="image-classifier.html#cb424-16"></a>    <span class="kw">const</span> classifier <span class="op">=</span> <span class="va">ml5</span>.<span class="at">imageClassifier</span>(<span class="st">&#39;MobileNet&#39;</span><span class="op">,</span> modelLoaded)<span class="op">;</span></span>
<span id="cb424-17"><a href="image-classifier.html#cb424-17"></a></span>
<span id="cb424-18"><a href="image-classifier.html#cb424-18"></a>    <span class="co">// Runs when the model is loaded</span></span>
<span id="cb424-19"><a href="image-classifier.html#cb424-19"></a>    <span class="kw">function</span> <span class="at">modelLoaded</span>() <span class="op">{</span></span>
<span id="cb424-20"><a href="image-classifier.html#cb424-20"></a>      <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Model Loaded!&#39;</span>)<span class="op">;</span></span>
<span id="cb424-21"><a href="image-classifier.html#cb424-21"></a>    <span class="op">}</span></span>
<span id="cb424-22"><a href="image-classifier.html#cb424-22"></a></span>
<span id="cb424-23"><a href="image-classifier.html#cb424-23"></a>    <span class="co">// Make a prediction with a selected image</span></span>
<span id="cb424-24"><a href="image-classifier.html#cb424-24"></a>    <span class="va">classifier</span>.<span class="at">classify</span>(<span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;dog&#39;</span>)<span class="op">,</span> (err<span class="op">,</span> results) <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb424-25"><a href="image-classifier.html#cb424-25"></a>      <span class="va">console</span>.<span class="at">log</span>(results)<span class="op">;</span></span>
<span id="cb424-26"><a href="image-classifier.html#cb424-26"></a>    <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb424-27"><a href="image-classifier.html#cb424-27"></a>  <span class="kw">&lt;/script&gt;</span></span>
<span id="cb424-28"><a href="image-classifier.html#cb424-28"></a><span class="kw">&lt;/body&gt;</span></span>
<span id="cb424-29"><a href="image-classifier.html#cb424-29"></a></span>
<span id="cb424-30"><a href="image-classifier.html#cb424-30"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
</div>
<div id="setup" class="section level2" number="20.2">
<h2><span class="header-section-number">20.2</span> Setup</h2>
<p>In shiny, we would need to pass the id of the image (<code>dog</code> above) to be sent from the server and the callback function to return the results to R. The projects starts from an empty directory, before creating actual application let us create the directory of static files that will contain the JavaScript file (<code>classify.js</code>) and the images to classify. Feel free download whichever images you want, below we download images of birds from Wikipedia.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="image-classifier.html#cb425-1"></a><span class="co"># static files</span></span>
<span id="cb425-2"><a href="image-classifier.html#cb425-2"></a><span class="kw">dir.create</span>(<span class="st">&quot;www&quot;</span>)</span>
<span id="cb425-3"><a href="image-classifier.html#cb425-3"></a><span class="kw">file.create</span>(<span class="st">&quot;www/classify.js&quot;</span>)</span>
<span id="cb425-4"><a href="image-classifier.html#cb425-4"></a></span>
<span id="cb425-5"><a href="image-classifier.html#cb425-5"></a><span class="co"># flamingo</span></span>
<span id="cb425-6"><a href="image-classifier.html#cb425-6"></a>fl &lt;-<span class="st"> </span><span class="kw">paste0</span>(</span>
<span id="cb425-7"><a href="image-classifier.html#cb425-7"></a>  <span class="st">&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/7/72/American_flamingo&quot;</span>,</span>
<span id="cb425-8"><a href="image-classifier.html#cb425-8"></a>  <span class="st">&quot;_%28Phoenicopterus_ruber%29.JPG/256px-American_flamingo_%28Phoenicopterus_ruber%29.JPG&quot;</span></span>
<span id="cb425-9"><a href="image-classifier.html#cb425-9"></a>)</span>
<span id="cb425-10"><a href="image-classifier.html#cb425-10"></a></span>
<span id="cb425-11"><a href="image-classifier.html#cb425-11"></a><span class="co"># lorikeet</span></span>
<span id="cb425-12"><a href="image-classifier.html#cb425-12"></a>lo &lt;-<span class="st"> </span><span class="kw">paste0</span>(</span>
<span id="cb425-13"><a href="image-classifier.html#cb425-13"></a>  <span class="st">&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/c/c2/Rainbow_lorikeet.jpg/&quot;</span>,</span>
<span id="cb425-14"><a href="image-classifier.html#cb425-14"></a>  <span class="st">&quot;256px-Rainbow_lorikeet.jpg&quot;</span></span>
<span id="cb425-15"><a href="image-classifier.html#cb425-15"></a>)</span>
<span id="cb425-16"><a href="image-classifier.html#cb425-16"></a></span>
<span id="cb425-17"><a href="image-classifier.html#cb425-17"></a><span class="co"># download</span></span>
<span id="cb425-18"><a href="image-classifier.html#cb425-18"></a><span class="kw">download.file</span>(fl, <span class="dt">destfile =</span> <span class="st">&quot;www/flamingo.jpg&quot;</span>)</span>
<span id="cb425-19"><a href="image-classifier.html#cb425-19"></a><span class="kw">download.file</span>(lo, <span class="dt">destfile =</span> <span class="st">&quot;www/lorikeet.jpg&quot;</span>)</span></code></pre></div>
<p>Once images are downloaded we can build the basic skeleton of the app. We import ml5.js from the CDN, create a select input to switch between the two images of birds that were downloaded and use <code>renderUI</code> to dynamically render the selected image. Finally, we create a button to trigger the classification, though it currently sends an empty list to a message handler that we are yet to create.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="image-classifier.html#cb426-1"></a><span class="kw">library</span>(<span class="st">&quot;shiny&quot;</span>)</span>
<span id="cb426-2"><a href="image-classifier.html#cb426-2"></a></span>
<span id="cb426-3"><a href="image-classifier.html#cb426-3"></a><span class="kw">addResourcePath</span>(<span class="st">&quot;www&quot;</span>, <span class="st">&quot;www&quot;</span>)</span>
<span id="cb426-4"><a href="image-classifier.html#cb426-4"></a></span>
<span id="cb426-5"><a href="image-classifier.html#cb426-5"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb426-6"><a href="image-classifier.html#cb426-6"></a>  tags<span class="op">$</span><span class="kw">head</span>(</span>
<span id="cb426-7"><a href="image-classifier.html#cb426-7"></a>    tags<span class="op">$</span><span class="kw">script</span>(<span class="dt">src =</span> <span class="st">&quot;https://unpkg.com/ml5@0.4.3/dist/ml5.min.js&quot;</span>)</span>
<span id="cb426-8"><a href="image-classifier.html#cb426-8"></a>  ),</span>
<span id="cb426-9"><a href="image-classifier.html#cb426-9"></a>  <span class="kw">fluidRow</span>(</span>
<span id="cb426-10"><a href="image-classifier.html#cb426-10"></a>    <span class="kw">column</span>(</span>
<span id="cb426-11"><a href="image-classifier.html#cb426-11"></a>      <span class="dv">2</span>,</span>
<span id="cb426-12"><a href="image-classifier.html#cb426-12"></a>      <span class="kw">selectInput</span>(</span>
<span id="cb426-13"><a href="image-classifier.html#cb426-13"></a>        <span class="st">&quot;select&quot;</span>, <span class="st">&quot;Select an image to classify&quot;</span>,</span>
<span id="cb426-14"><a href="image-classifier.html#cb426-14"></a>        <span class="dt">choices =</span> <span class="kw">c</span>(<span class="st">&quot;lorikeet&quot;</span>, <span class="st">&quot;flamingo&quot;</span>)</span>
<span id="cb426-15"><a href="image-classifier.html#cb426-15"></a>      )</span>
<span id="cb426-16"><a href="image-classifier.html#cb426-16"></a>    ),</span>
<span id="cb426-17"><a href="image-classifier.html#cb426-17"></a>    <span class="kw">column</span>(</span>
<span id="cb426-18"><a href="image-classifier.html#cb426-18"></a>      <span class="dv">2</span>, <span class="kw">br</span>(), <span class="kw">actionButton</span>(<span class="st">&quot;classify&quot;</span>, <span class="st">&quot;Classify&quot;</span>, <span class="dt">icon =</span> <span class="kw">icon</span>(<span class="st">&quot;search&quot;</span>))</span>
<span id="cb426-19"><a href="image-classifier.html#cb426-19"></a>    )</span>
<span id="cb426-20"><a href="image-classifier.html#cb426-20"></a>  ),</span>
<span id="cb426-21"><a href="image-classifier.html#cb426-21"></a>  <span class="kw">uiOutput</span>(<span class="st">&quot;img&quot;</span>)</span>
<span id="cb426-22"><a href="image-classifier.html#cb426-22"></a>)</span>
<span id="cb426-23"><a href="image-classifier.html#cb426-23"></a></span>
<span id="cb426-24"><a href="image-classifier.html#cb426-24"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</span>
<span id="cb426-25"><a href="image-classifier.html#cb426-25"></a></span>
<span id="cb426-26"><a href="image-classifier.html#cb426-26"></a>  output<span class="op">$</span>img &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</span>
<span id="cb426-27"><a href="image-classifier.html#cb426-27"></a>    path &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;www/&quot;</span>, input<span class="op">$</span>select, <span class="st">&quot;.jpg&quot;</span>)</span>
<span id="cb426-28"><a href="image-classifier.html#cb426-28"></a>    tags<span class="op">$</span><span class="kw">img</span>(<span class="dt">src =</span> path, <span class="dt">id =</span> <span class="st">&quot;bird&quot;</span>)</span>
<span id="cb426-29"><a href="image-classifier.html#cb426-29"></a>  })</span>
<span id="cb426-30"><a href="image-classifier.html#cb426-30"></a></span>
<span id="cb426-31"><a href="image-classifier.html#cb426-31"></a>  <span class="kw">observeEvent</span>(input<span class="op">$</span>classify, {</span>
<span id="cb426-32"><a href="image-classifier.html#cb426-32"></a>    session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="st">&#39;classify&#39;</span>, <span class="kw">list</span>())</span>
<span id="cb426-33"><a href="image-classifier.html#cb426-33"></a>  })</span>
<span id="cb426-34"><a href="image-classifier.html#cb426-34"></a></span>
<span id="cb426-35"><a href="image-classifier.html#cb426-35"></a>}</span>
<span id="cb426-36"><a href="image-classifier.html#cb426-36"></a></span>
<span id="cb426-37"><a href="image-classifier.html#cb426-37"></a><span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure">
<img src="images/ml5-init.png" alt="" />
<p class="caption">Classifier skeleton</p>
</div>
</div>
<div id="javascript" class="section level2" number="20.3">
<h2><span class="header-section-number">20.3</span> JavaScript</h2>
<p>With this in place one can start thinking about the JavaScript, when the “classify” button is clicked the classification must be triggered in the client and the result sent back. To do so we need to define the message handler called “classify” to which the data is sent.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb427-1"><a href="image-classifier.html#cb427-1"></a><span class="co">// classify.js</span></span>
<span id="cb427-2"><a href="image-classifier.html#cb427-2"></a></span>
<span id="cb427-3"><a href="image-classifier.html#cb427-3"></a><span class="co">// Initialize </span></span>
<span id="cb427-4"><a href="image-classifier.html#cb427-4"></a><span class="kw">const</span> classifier <span class="op">=</span> <span class="va">ml5</span>.<span class="at">imageClassifier</span>(<span class="st">&#39;MobileNet&#39;</span><span class="op">,</span> modelLoaded)<span class="op">;</span></span>
<span id="cb427-5"><a href="image-classifier.html#cb427-5"></a></span>
<span id="cb427-6"><a href="image-classifier.html#cb427-6"></a><span class="kw">function</span> <span class="at">modelLoaded</span>() <span class="op">{</span></span>
<span id="cb427-7"><a href="image-classifier.html#cb427-7"></a>  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Model Loaded!&#39;</span>)<span class="op">;</span></span>
<span id="cb427-8"><a href="image-classifier.html#cb427-8"></a><span class="op">}</span></span>
<span id="cb427-9"><a href="image-classifier.html#cb427-9"></a></span>
<span id="cb427-10"><a href="image-classifier.html#cb427-10"></a><span class="va">Shiny</span>.<span class="at">addCustomMessageHandler</span>(<span class="st">&#39;classify&#39;</span><span class="op">,</span> <span class="kw">function</span>(data)<span class="op">{</span></span>
<span id="cb427-11"><a href="image-classifier.html#cb427-11"></a>  <span class="co">// Make a prediction with a selected image</span></span>
<span id="cb427-12"><a href="image-classifier.html#cb427-12"></a>  <span class="va">classifier</span>.<span class="at">classify</span>(<span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;bird&quot;</span>)<span class="op">,</span> (err<span class="op">,</span> results) <span class="kw">=&gt;</span> <span class="op">{</span></span>
<span id="cb427-13"><a href="image-classifier.html#cb427-13"></a>    <span class="va">Shiny</span>.<span class="at">setInputValue</span>(<span class="st">&quot;classification&quot;</span><span class="op">,</span> results)<span class="op">;</span></span>
<span id="cb427-14"><a href="image-classifier.html#cb427-14"></a>  <span class="op">}</span>)<span class="op">;</span></span>
<span id="cb427-15"><a href="image-classifier.html#cb427-15"></a><span class="op">}</span>)<span class="op">;</span></span></code></pre></div>
<p>A few things to note on the above. The classifier is created outside of the message handler as this only has to be done once and not every time the “classify” button is clicked. While the message handler accepts the <code>data</code> objects it does not make use of it, which is fine, the argument must nonetheless be specified. In the aforementioned callback function the input “classification” is defined.</p>
</div>
<div id="input-handler" class="section level2" number="20.4">
<h2><span class="header-section-number">20.4</span> Input Handler</h2>
<p>We can then proceed to running the shiny application and observe the classifier in action.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="image-classifier.html#cb428-1"></a><span class="kw">library</span>(<span class="st">&quot;shiny&quot;</span>)</span>
<span id="cb428-2"><a href="image-classifier.html#cb428-2"></a></span>
<span id="cb428-3"><a href="image-classifier.html#cb428-3"></a><span class="kw">addResourcePath</span>(<span class="st">&quot;www&quot;</span>, <span class="st">&quot;www&quot;</span>)</span>
<span id="cb428-4"><a href="image-classifier.html#cb428-4"></a></span>
<span id="cb428-5"><a href="image-classifier.html#cb428-5"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb428-6"><a href="image-classifier.html#cb428-6"></a>  tags<span class="op">$</span><span class="kw">head</span>(</span>
<span id="cb428-7"><a href="image-classifier.html#cb428-7"></a>    tags<span class="op">$</span><span class="kw">script</span>(<span class="dt">src =</span> <span class="st">&quot;https://unpkg.com/ml5@0.4.3/dist/ml5.min.js&quot;</span>),</span>
<span id="cb428-8"><a href="image-classifier.html#cb428-8"></a>    tags<span class="op">$</span><span class="kw">script</span>(<span class="dt">src =</span> <span class="st">&quot;www/classify.js&quot;</span>)</span>
<span id="cb428-9"><a href="image-classifier.html#cb428-9"></a>  ),</span>
<span id="cb428-10"><a href="image-classifier.html#cb428-10"></a>  <span class="kw">fluidRow</span>(</span>
<span id="cb428-11"><a href="image-classifier.html#cb428-11"></a>    <span class="kw">column</span>(</span>
<span id="cb428-12"><a href="image-classifier.html#cb428-12"></a>      <span class="dv">2</span>,</span>
<span id="cb428-13"><a href="image-classifier.html#cb428-13"></a>      <span class="kw">selectInput</span>(</span>
<span id="cb428-14"><a href="image-classifier.html#cb428-14"></a>        <span class="st">&quot;select&quot;</span>, <span class="st">&quot;Select an image to classify&quot;</span>,</span>
<span id="cb428-15"><a href="image-classifier.html#cb428-15"></a>        <span class="dt">choices =</span> <span class="kw">c</span>(<span class="st">&quot;lorikeet&quot;</span>, <span class="st">&quot;flamingo&quot;</span>)</span>
<span id="cb428-16"><a href="image-classifier.html#cb428-16"></a>      )</span>
<span id="cb428-17"><a href="image-classifier.html#cb428-17"></a>    ),</span>
<span id="cb428-18"><a href="image-classifier.html#cb428-18"></a>    <span class="kw">column</span>(</span>
<span id="cb428-19"><a href="image-classifier.html#cb428-19"></a>      <span class="dv">2</span>, <span class="kw">br</span>(), <span class="kw">actionButton</span>(<span class="st">&quot;classify&quot;</span>, <span class="st">&quot;Classify&quot;</span>, <span class="dt">icon =</span> <span class="kw">icon</span>(<span class="st">&quot;search&quot;</span>))</span>
<span id="cb428-20"><a href="image-classifier.html#cb428-20"></a>    )</span>
<span id="cb428-21"><a href="image-classifier.html#cb428-21"></a>  ),</span>
<span id="cb428-22"><a href="image-classifier.html#cb428-22"></a>  <span class="kw">uiOutput</span>(<span class="st">&quot;img&quot;</span>),</span>
<span id="cb428-23"><a href="image-classifier.html#cb428-23"></a>  <span class="kw">verbatimTextOutput</span>(<span class="st">&quot;results&quot;</span>) <span class="co"># print output</span></span>
<span id="cb428-24"><a href="image-classifier.html#cb428-24"></a>)</span>
<span id="cb428-25"><a href="image-classifier.html#cb428-25"></a></span>
<span id="cb428-26"><a href="image-classifier.html#cb428-26"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</span>
<span id="cb428-27"><a href="image-classifier.html#cb428-27"></a></span>
<span id="cb428-28"><a href="image-classifier.html#cb428-28"></a>  output<span class="op">$</span>img &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</span>
<span id="cb428-29"><a href="image-classifier.html#cb428-29"></a>    path &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;www/&quot;</span>, input<span class="op">$</span>select, <span class="st">&quot;.jpg&quot;</span>)</span>
<span id="cb428-30"><a href="image-classifier.html#cb428-30"></a>    tags<span class="op">$</span><span class="kw">img</span>(<span class="dt">src =</span> path, <span class="dt">id =</span> <span class="st">&quot;bird&quot;</span>)</span>
<span id="cb428-31"><a href="image-classifier.html#cb428-31"></a>  })</span>
<span id="cb428-32"><a href="image-classifier.html#cb428-32"></a></span>
<span id="cb428-33"><a href="image-classifier.html#cb428-33"></a>  <span class="kw">observeEvent</span>(input<span class="op">$</span>classify, {</span>
<span id="cb428-34"><a href="image-classifier.html#cb428-34"></a>    session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="st">&#39;classify&#39;</span>, <span class="kw">list</span>())</span>
<span id="cb428-35"><a href="image-classifier.html#cb428-35"></a>  })</span>
<span id="cb428-36"><a href="image-classifier.html#cb428-36"></a></span>
<span id="cb428-37"><a href="image-classifier.html#cb428-37"></a>  <span class="co"># render classification</span></span>
<span id="cb428-38"><a href="image-classifier.html#cb428-38"></a>  output<span class="op">$</span>results &lt;-<span class="st"> </span><span class="kw">renderPrint</span>({</span>
<span id="cb428-39"><a href="image-classifier.html#cb428-39"></a>    input<span class="op">$</span>classification</span>
<span id="cb428-40"><a href="image-classifier.html#cb428-40"></a>  })</span>
<span id="cb428-41"><a href="image-classifier.html#cb428-41"></a></span>
<span id="cb428-42"><a href="image-classifier.html#cb428-42"></a>}</span>
<span id="cb428-43"><a href="image-classifier.html#cb428-43"></a></span>
<span id="cb428-44"><a href="image-classifier.html#cb428-44"></a><span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure">
<img src="images/ml5-output.png" alt="" />
<p class="caption">Classifier output</p>
</div>
<p>This returns three results, the label (classification) and the confidence, which could be improved, we ought to build an input handler to transform that into a readable table. Below we add the input handler and register it with shiny. Do not forget to use it in the message handler in JavaScript like so: <code>Shiny.setInputValue("classification:class", results);</code>.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="image-classifier.html#cb429-1"></a><span class="kw">library</span>(<span class="st">&quot;shiny&quot;</span>)</span>
<span id="cb429-2"><a href="image-classifier.html#cb429-2"></a></span>
<span id="cb429-3"><a href="image-classifier.html#cb429-3"></a><span class="kw">addResourcePath</span>(<span class="st">&quot;www&quot;</span>, <span class="st">&quot;www&quot;</span>)</span>
<span id="cb429-4"><a href="image-classifier.html#cb429-4"></a></span>
<span id="cb429-5"><a href="image-classifier.html#cb429-5"></a><span class="co"># create handler</span></span>
<span id="cb429-6"><a href="image-classifier.html#cb429-6"></a>handler &lt;-<span class="st"> </span><span class="cf">function</span>(data, ...){</span>
<span id="cb429-7"><a href="image-classifier.html#cb429-7"></a>  purrr<span class="op">::</span><span class="kw">map_dfr</span>(data, as.data.frame)</span>
<span id="cb429-8"><a href="image-classifier.html#cb429-8"></a>}</span>
<span id="cb429-9"><a href="image-classifier.html#cb429-9"></a></span>
<span id="cb429-10"><a href="image-classifier.html#cb429-10"></a><span class="co"># register handler</span></span>
<span id="cb429-11"><a href="image-classifier.html#cb429-11"></a>shiny<span class="op">::</span><span class="kw">registerInputHandler</span>(<span class="st">&quot;class&quot;</span>, handler)</span>
<span id="cb429-12"><a href="image-classifier.html#cb429-12"></a></span>
<span id="cb429-13"><a href="image-classifier.html#cb429-13"></a>ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</span>
<span id="cb429-14"><a href="image-classifier.html#cb429-14"></a>  tags<span class="op">$</span><span class="kw">head</span>(</span>
<span id="cb429-15"><a href="image-classifier.html#cb429-15"></a>    tags<span class="op">$</span><span class="kw">script</span>(<span class="dt">src =</span> <span class="st">&quot;https://unpkg.com/ml5@0.4.3/dist/ml5.min.js&quot;</span>),</span>
<span id="cb429-16"><a href="image-classifier.html#cb429-16"></a>    tags<span class="op">$</span><span class="kw">script</span>(<span class="dt">src =</span> <span class="st">&quot;www/classify.js&quot;</span>)</span>
<span id="cb429-17"><a href="image-classifier.html#cb429-17"></a>  ),</span>
<span id="cb429-18"><a href="image-classifier.html#cb429-18"></a>  <span class="kw">fluidRow</span>(</span>
<span id="cb429-19"><a href="image-classifier.html#cb429-19"></a>    <span class="kw">column</span>(</span>
<span id="cb429-20"><a href="image-classifier.html#cb429-20"></a>      <span class="dv">2</span>,</span>
<span id="cb429-21"><a href="image-classifier.html#cb429-21"></a>      <span class="kw">selectInput</span>(</span>
<span id="cb429-22"><a href="image-classifier.html#cb429-22"></a>        <span class="st">&quot;select&quot;</span>, <span class="st">&quot;Select an image to classify&quot;</span>,</span>
<span id="cb429-23"><a href="image-classifier.html#cb429-23"></a>        <span class="dt">choices =</span> <span class="kw">c</span>(<span class="st">&quot;lorikeet&quot;</span>, <span class="st">&quot;flamingo&quot;</span>)</span>
<span id="cb429-24"><a href="image-classifier.html#cb429-24"></a>      )</span>
<span id="cb429-25"><a href="image-classifier.html#cb429-25"></a>    ),</span>
<span id="cb429-26"><a href="image-classifier.html#cb429-26"></a>    <span class="kw">column</span>(</span>
<span id="cb429-27"><a href="image-classifier.html#cb429-27"></a>      <span class="dv">2</span>, <span class="kw">br</span>(), <span class="kw">actionButton</span>(<span class="st">&quot;classify&quot;</span>, <span class="st">&quot;Classify&quot;</span>, <span class="dt">icon =</span> <span class="kw">icon</span>(<span class="st">&quot;search&quot;</span>))</span>
<span id="cb429-28"><a href="image-classifier.html#cb429-28"></a>    )</span>
<span id="cb429-29"><a href="image-classifier.html#cb429-29"></a>  ),</span>
<span id="cb429-30"><a href="image-classifier.html#cb429-30"></a>  <span class="kw">uiOutput</span>(<span class="st">&quot;img&quot;</span>),</span>
<span id="cb429-31"><a href="image-classifier.html#cb429-31"></a>  <span class="kw">verbatimTextOutput</span>(<span class="st">&quot;results&quot;</span>)</span>
<span id="cb429-32"><a href="image-classifier.html#cb429-32"></a>)</span>
<span id="cb429-33"><a href="image-classifier.html#cb429-33"></a></span>
<span id="cb429-34"><a href="image-classifier.html#cb429-34"></a>server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session){</span>
<span id="cb429-35"><a href="image-classifier.html#cb429-35"></a></span>
<span id="cb429-36"><a href="image-classifier.html#cb429-36"></a>  output<span class="op">$</span>img &lt;-<span class="st"> </span><span class="kw">renderUI</span>({</span>
<span id="cb429-37"><a href="image-classifier.html#cb429-37"></a>    path &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;www/&quot;</span>, input<span class="op">$</span>select, <span class="st">&quot;.jpg&quot;</span>)</span>
<span id="cb429-38"><a href="image-classifier.html#cb429-38"></a>    tags<span class="op">$</span><span class="kw">img</span>(<span class="dt">src =</span> path, <span class="dt">id =</span> <span class="st">&quot;bird&quot;</span>)</span>
<span id="cb429-39"><a href="image-classifier.html#cb429-39"></a>  })</span>
<span id="cb429-40"><a href="image-classifier.html#cb429-40"></a></span>
<span id="cb429-41"><a href="image-classifier.html#cb429-41"></a>  <span class="kw">observeEvent</span>(input<span class="op">$</span>classify, {</span>
<span id="cb429-42"><a href="image-classifier.html#cb429-42"></a>    session<span class="op">$</span><span class="kw">sendCustomMessage</span>(<span class="st">&#39;classify&#39;</span>, <span class="kw">list</span>())</span>
<span id="cb429-43"><a href="image-classifier.html#cb429-43"></a>  })</span>
<span id="cb429-44"><a href="image-classifier.html#cb429-44"></a></span>
<span id="cb429-45"><a href="image-classifier.html#cb429-45"></a>  output<span class="op">$</span>results &lt;-<span class="st"> </span><span class="kw">renderPrint</span>({</span>
<span id="cb429-46"><a href="image-classifier.html#cb429-46"></a>    input<span class="op">$</span>classification</span>
<span id="cb429-47"><a href="image-classifier.html#cb429-47"></a>  })</span>
<span id="cb429-48"><a href="image-classifier.html#cb429-48"></a></span>
<span id="cb429-49"><a href="image-classifier.html#cb429-49"></a>}</span>
<span id="cb429-50"><a href="image-classifier.html#cb429-50"></a></span>
<span id="cb429-51"><a href="image-classifier.html#cb429-51"></a><span class="kw">shinyApp</span>(ui, server)</span></code></pre></div>
<div class="figure">
<img src="images/ml5-table.png" alt="" />
<p class="caption">Classifier table output</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="node.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="progress-bar.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/JohnCoene/javascript-for-r/edit/master/7-31-examples-ml5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
